<%= breadcrumb(['Início', root_path], ['Conexões', nil]) %>
<div class="mb-8">
  <h1 class="text-3xl font-semibold text-slate-900 mb-2">Conexões Aluno ↔ Mentor</h1>
  <p class="text-sm text-slate-600">Sugestões automáticas baseadas em interesses, disponibilidade e objetivo de aprendizagem.</p>
</div>
<% if @matches.empty? %>
  <p class="text-sm text-slate-500">Nenhum aluno cadastrado para gerar conexões.</p>
<% else %>
  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3" data-animate-stagger>
    <% @matches.each do |item| %>
      <% student = item[:student]; mentor = item[:mentor]; score = item[:score] %>
      <div class="rounded-xl bg-white border border-slate-200 p-5 shadow-sm hover:shadow-md transition flex flex-col">
        <div class="flex items-start justify-between mb-2">
          <h2 class="font-semibold text-slate-900 text-base"><%= student.full_name %></h2>
          <% if student.proficiency_level.present? %>
            <span class="text-[10px] uppercase tracking-wide font-semibold bg-slate-100 text-slate-600 px-2 py-1 rounded"><%= student.proficiency_level %></span>
          <% end %>
        </div>
        <div class="mb-2 flex flex-wrap gap-1">
          <% student.interests_tokens.each do |i| %>
            <span class="text-[10px] font-medium bg-slate-900 text-white px-2 py-1 rounded"><%= i %></span>
          <% end %>
        </div>
        <p class="text-xs text-slate-600 mb-3 line-clamp-4"><%= student.learning_goal.presence || 'Sem objetivo.' %></p>
        <% if mentor %>
          <div class="mt-auto rounded-lg border border-brand-200 bg-brand-50 p-3">
            <div class="flex items-center justify-between mb-1">
              <span class="text-[11px] font-semibold text-brand-700">Mentor sugerido</span>
              <span class="text-[10px] font-bold text-brand-600">Score <%= score %></span>
            </div>
            <p class="text-sm font-medium text-slate-900"><%= mentor.full_name %> <span class="text-[10px] ml-2 uppercase tracking-wide bg-slate-200 text-slate-700 px-1.5 py-0.5 rounded"><%= mentor.expertise %></span></p>
            <p class="text-xs text-slate-600 mt-1"><%= mentor.bio.to_s.truncate(90) %></p>
            <div class="mt-2 flex gap-3 text-[11px] font-semibold">
              <%= link_to 'Ver Mentor', mentor_path(mentor), class: 'text-brand-600 hover:text-brand-700' %>
              <%= link_to 'Ver Aluno', student_path(student), class: 'text-slate-600 hover:text-slate-800' %>
            </div>
          </div>
        <% else %>
          <div class="mt-auto rounded-lg border border-slate-200 bg-slate-50 p-3 text-xs text-slate-600">
            Nenhum mentor ideal encontrado ainda.
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
</div>
